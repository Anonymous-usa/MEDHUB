{% extends "base.html" %}

{% block title %}üè• –ú–æ—ë —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ ‚Äî {{ institution.name }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">üè• –ú–æ—ë —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ: <strong>{{ institution.name }}</strong></h2>

  <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
  <details open class="mb-4">
    <summary class="summary-toggle h5 mb-2">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—á—Ä–µ–∂–¥–µ–Ω–∏–∏</summary>
    <div class="mt-3">
      <p><strong>–¢–∏–ø:</strong> {{ institution.get_institution_type_display }}</p>
      <p><strong>–†–µ–≥–∏–æ–Ω:</strong> {{ institution.region }}</p>
      <p><strong>–°—Ç–∞—Ç—É—Å:</strong>
        <span class="badge {% if institution.is_active %}bg-success{% else %}bg-secondary{% endif %}">
          {% if institution.is_active %}‚úÖ –ê–∫—Ç–∏–≤–Ω–æ{% else %}‚ùå –ù–µ–∞–∫—Ç–∏–≤–Ω–æ{% endif %}
        </span>
      </p>
    </div>
  </details>

  <!-- –û—Ç–¥–µ–ª–µ–Ω–∏—è -->
  <details open class="mb-4">
    <summary class="summary-toggle h5 mb-2">üìÇ –û—Ç–¥–µ–ª–µ–Ω–∏—è</summary>
    <ul class="list-group mt-3">
      {% for dept in departments %}
        <li class="list-group-item">üè¢ {{ dept.name }}</li>
      {% empty %}
        <li class="list-group-item text-muted">–ù–µ—Ç –æ—Ç–¥–µ–ª–µ–Ω–∏–π</li>
      {% endfor %}
    </ul>
  </details>

  <!-- –í—Ä–∞—á–∏ -->
  <details open class="mb-4">
    <summary class="summary-toggle h5 mb-2">üßë‚Äç‚öïÔ∏è –í—Ä–∞—á–∏</summary>
    <ul class="list-group mt-3">
      {% for doctor in doctors %}
        <li class="list-group-item">
          üë®‚Äç‚öïÔ∏è {{ doctor.get_full_name }} ‚Äî <span class="text-muted">üìû {{ doctor.phone_number }}</span>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">–ù–µ—Ç –≤—Ä–∞—á–µ–π</li>
      {% endfor %}
    </ul>
  </details>

  <!-- –ó–∞—è–≤–∫–∏ -->
  <details open class="mb-4">
    <summary class="summary-toggle h5 mb-2">üìÖ –ó–∞—è–≤–∫–∏</summary>
    <ul class="list-group mt-3">
      {% for app in appointments %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ app.patient.get_full_name }} ‚Üí {{ app.doctor.get_full_name }}
          <span class="badge 
            {% if app.status == 'accepted' %}bg-success
            {% elif app.status == 'pending' %}bg-warning text-dark
            {% elif app.status == 'rejected' %}bg-danger
            {% else %}bg-secondary{% endif %}">
            {% if app.status == 'accepted' %}‚úÖ –ü—Ä–∏–Ω—è—Ç–∞
            {% elif app.status == 'pending' %}‚è≥ –í –æ–∂–∏–¥–∞–Ω–∏–∏
            {% elif app.status == 'rejected' %}‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–∞
            {% else %}‚ùî –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ{% endif %}
          </span>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">–ù–µ—Ç –∑–∞—è–≤–æ–∫</li>
      {% endfor %}
    </ul>
  </details>

  <!-- –û—Ç–∑—ã–≤—ã -->
  <details open class="mb-5">
    <summary class="summary-toggle h5 mb-2">üìù –û—Ç–∑—ã–≤—ã</summary>
    <ul class="list-group mt-3">
      {% for review in reviews %}
        <li class="list-group-item">
          {{ review.appointment.patient.get_full_name }} ‚Üí {{ review.appointment.doctor.get_full_name }}:
          <strong>{{ review.rating }} ‚òÖ</strong>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">–ù–µ—Ç –æ—Ç–∑—ã–≤–æ–≤</li>
      {% endfor %}
    </ul>
  </details>
</div>

<!-- –°—Ç–∏–ª–∏ –¥–ª—è summary -->
<style>
  .summary-toggle {
    cursor: pointer;
    user-select: none;
    list-style: none;
  }
  details > summary::-webkit-details-marker {
    display: none;
  }
  details > summary::before {
    content: "‚ñ∏";
    display: inline-block;
    margin-right: 8px;
    transition: transform 0.2s ease;
  }
  details[open] > summary::before {
    transform: rotate(90deg);
  }
</style>
{% endblock %}
