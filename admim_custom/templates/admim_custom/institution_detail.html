{% extends "base.html" %}

{% block title %}🏥 {{ institution.name }} — MEDHUB.TJ{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">🏥 {{ institution.name }}</h2>

  <!-- Информация об учреждении -->
  <details open class="mb-4">
    <summary class="summary-toggle h5">📌 Информация об учреждении</summary>
    <div class="mt-3">
      <p><strong>Тип:</strong> {{ institution.get_institution_type_display }}</p>
      <p><strong>Регион:</strong> {{ institution.region }}</p>
      <p><strong>Статус:</strong>
        <span class="badge {% if institution.is_active %}bg-success{% else %}bg-secondary{% endif %}">
          {{ institution.is_active|yesno:"Активно,Неактивно" }}
        </span>
      </p>
    </div>
  </details>

  <!-- Отделения -->
  <details open class="mb-4">
    <summary class="summary-toggle h5">📂 Отделения</summary>
    <ul class="list-group mt-3">
      {% for dept in departments %}
        <li class="list-group-item">🏬 {{ dept.name }}</li>
      {% empty %}
        <li class="list-group-item text-muted">Нет отделений</li>
      {% endfor %}
    </ul>
  </details>

  <!-- Врачи -->
  <details open class="mb-4">
    <summary class="summary-toggle h5">🧑‍⚕️ Врачи</summary>
    <ul class="list-group mt-3">
      {% for doctor in doctors %}
        <li class="list-group-item">
          👨‍⚕️ {{ doctor.get_full_name }} — <span class="text-muted">📞 {{ doctor.phone_number }}</span>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">Нет врачей</li>
      {% endfor %}
    </ul>
  </details>

  <!-- Заявки -->
  <details open class="mb-4">
    <summary class="summary-toggle h5">📅 Заявки</summary>
    <ul class="list-group mt-3">
      {% for app in appointments %}
        <li class="list-group-item">
          🙍 {{ app.patient }} → 🧑‍⚕️ {{ app.doctor }}
          <span class="badge bg-info text-dark">{{ app.status }}</span>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">Нет заявок</li>
      {% endfor %}
    </ul>
  </details>

  <!-- Отзывы -->
  <details open class="mb-5">
    <summary class="summary-toggle h5">📝 Отзывы</summary>
    <ul class="list-group mt-3">
      {% for review in reviews %}
        <li class="list-group-item">
          🙍 {{ review.appointment.patient }} → 🧑‍⚕️ {{ review.appointment.doctor }}:
          <strong>{{ review.rating }} ★</strong>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">Нет отзывов</li>
      {% endfor %}
    </ul>
  </details>
</div>

<!-- Стили для summary -->
<style>
  .summary-toggle {
    cursor: pointer;
    user-select: none;
    list-style: none;
  }
  details > summary::-webkit-details-marker {
    display: none;
  }
  details > summary::before {
    content: "▸";
    display: inline-block;
    margin-right: 8px;
    transition: transform 0.2s ease;
  }
  details[open] > summary::before {
    transform: rotate(90deg);
  }
</style>
{% endblock %}
